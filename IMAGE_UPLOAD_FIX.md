# –†–µ—à–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –ø—Ä–∏ –∫–∞—á–≤–∞–Ω–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

## –ü—Ä–æ–±–ª–µ–º
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ —Å–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ (crash) —Å–ª–µ–¥ –∫–∞—á–≤–∞–Ω–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç –≥–∞–ª–µ—Ä–∏—è—Ç–∞ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.

## –ü—Ä–∏—á–∏–Ω–∏ –∑–∞ –ø—Ä–æ–±–ª–µ–º–∞
1. **–ì–æ–ª–µ–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** - Data URL —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ç–∞ –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –º–Ω–æ–≥–æ –≥–æ–ª—è–º–∞ (–Ω–∞–¥ 1-2 MB)
2. **–ü—Ä–µ–ø—ä–ª–≤–∞–Ω–µ –Ω–∞ storage** - useKV (spark.kv) –∏–º–∞ –ª–∏–º–∏—Ç –Ω–∞ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ
3. **Memory pressure** - –ì–æ–ª–µ–º–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–º–µ—Ç—Ç–∞ –º–æ–≥–∞—Ç –¥–∞ –ø—Ä–µ—Ç–æ–≤–∞—Ä—è—Ç –±—Ä–∞—É–∑—ä—Ä–∞
4. **–õ–∏–ø—Å–∞ –Ω–∞ error handling** - –ì—Ä–µ—à–∫–∏—Ç–µ –Ω–µ —Å–µ —Ö–≤–∞—â–∞—Ç –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ crash–≤–∞

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ê–≥—Ä–µ—Å–∏–≤–Ω–∞ –∫–æ–º–ø—Ä–µ—Å–∏—è –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ç–∞
**–§–∞–π–ª:** `src/components/screens/ImageUploadScreen.tsx`

- **–ù–∞–º–∞–ª–∏—Ö —Ä–∞–∑–º–µ—Ä–∞** –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ç–∞ –æ—Ç 600px -> 500px
- **–ù–∞–º–∞–ª–∏—Ö –∫–∞—á–µ—Å—Ç–≤–æ—Ç–æ** –æ—Ç 0.65 -> 0.6 (–ø—ä—Ä–≤–∏ pass)
- **–î–æ–±–∞–≤–∏—Ö –≤—Ç–æ—Ä–∏ pass** –∫–æ–º–ø—Ä–µ—Å–∏—è –ø—Ä–∏ –Ω—É–∂–¥–∞ (400px, 0.5 quality)
- **–î–æ–±–∞–≤–∏—Ö –º–∞–∫—Å–∏–º–∞–ª–µ–Ω –ª–∏–º–∏—Ç** - 200KB —Å–ª–µ–¥ –∫–æ–º–ø—Ä–µ—Å–∏—è
- **–ü–æ–¥—Ä–æ–±–Ω–∏ –ª–æ–≥–æ–≤–µ** –Ω–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞ –∑–∞ tracking –Ω–∞ —Ä–∞–∑–º–µ—Ä–∏—Ç–µ

```typescript
// –ü—Ä–µ–¥–∏
const compressImage = async (dataUrl: string, maxWidth: number = 600, quality: number = 0.65)

// –°–ª–µ–¥
const compressImage = async (dataUrl: string, maxWidth: number = 500, quality: number = 0.6)
```

### 2. –ü—Ä–µ–º–∞—Ö–Ω–∞—Ö —Å–ª–æ–∂–Ω–æ—Ç–æ SVG overlay —Ä–∏—Å—É–≤–∞–Ω–µ
**–§–∞–π–ª:** `src/components/iris/IrisCropEditor.tsx`

- –ü—Ä–µ–º–∞—Ö–Ω–∞—Ö –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ—Ç–æ –∏ —Ä–∏—Å—É–≤–∞–Ω–µ—Ç–æ –Ω–∞ SVG overlay –ø—Ä–∏ crop
- –¢–æ–≤–∞ –Ω–∞–º–∞–ª—è–≤–∞ –≤—Ä–µ–º–µ—Ç–æ –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —à–∞–Ω—Å–∞ –∑–∞ –≥—Ä–µ—à–∫–∏
- Overlay-—ä—Ç —Å–µ –ø–æ–∫–∞–∑–≤–∞ —Å–∞–º–æ –≤–∏–∑—É–∞–ª–Ω–æ –≤ UI, –Ω–µ —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ—Ç–æ

### 3. –ü–æ-–¥–æ–±—Ä–æ error handling –≤ App.tsx
**–§–∞–π–ª:** `src/App.tsx`

- –î–æ–±–∞–≤–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ —Ä–∞–∑–º–µ—Ä –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ç–∞ (–º–∞–∫—Å 300KB)
- –î–æ–±–∞–≤–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ storage usage (–∞–∫–æ –µ –Ω–∞–¥ 90% - —Å–ø–∏—Ä–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ç–∞)
- –î–æ–±–∞–≤–∏—Ö –ø–æ–¥—Ä–æ–±–Ω–∏ –ª–æ–≥–æ–≤–µ –Ω–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞
- –î–æ–±–∞–≤–∏—Ö try-catch –±–ª–æ–∫–æ–≤–µ –∑–∞ –¥–∞ –Ω–µ crash–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ

### 4. –ù–æ–≤–∞ utility –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞ storage
**–§–∞–π–ª:** `src/lib/storage-utils.ts`

–°—ä–∑–¥–∞–¥–æ—Ö –Ω–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏–∏:
- `estimateStorageUsage()` - –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –∫–æ–ª–∫–æ % –æ—Ç storage —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞
- `checkStorageAvailable()` - –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ –∏–º–∞ –¥–æ—Å—Ç–∞—Ç—ä—á–Ω–æ –º—è—Å—Ç–æ
- `estimateDataSize()` - –∏–∑—á–∏—Å–ª—è–≤–∞ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –ø—Ä–µ–¥–∏ –∑–∞–ø–∞–∑–≤–∞–Ω–µ
- `clearOldAnalysisHistory()` - –∏–∑—á–∏—Å—Ç–≤–∞ —Å—Ç–∞—Ä–∏ –∞–Ω–∞–ª–∏–∑–∏ –∑–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–≤–∞–Ω–µ –Ω–∞ –º—è—Å—Ç–æ

### 5. –ü–æ–¥–æ–±—Ä–µ–Ω error logging
**–§–∞–π–ª:** `src/main.tsx`

- –ò–º–ø–æ—Ä—Ç–∏—Ä–∞—Ö errorLogger –≤ main.tsx
- –î–æ–±–∞–≤–∏—Ö –ø–æ-–¥–µ—Ç–∞–π–ª–Ω–∏ –ª–æ–≥–æ–≤–µ –∑–∞ storage –∏ canvas –≥—Ä–µ—à–∫–∏
- –í—Å–∏—á–∫–∏ –≥—Ä–µ—à–∫–∏ —Å–µ –∑–∞–ø–∏—Å–≤–∞—Ç –≤ errorLogger –∑–∞ debugging

### 6. –ü–æ–¥—Ä–æ–±–Ω–∏ console –ª–æ–≥–æ–≤–µ
–í—Å–∏—á–∫–∏ –∫—Ä–∏—Ç–∏—á–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–µ–≥–∞ –∏–º–∞—Ç –ª–æ–≥–æ–≤–µ —Å emoji –ø—Ä–µ—Ñ–∏–∫—Å–∏:
- üì∏ `[COMPRESS]` - –∫–æ–º–ø—Ä–µ—Å–∏—è –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- üíæ `[UPLOAD]` - –∫–∞—á–≤–∞–Ω–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÇÔ∏è `[CROP]` - crop –æ–ø–µ—Ä–∞—Ü–∏–∏
- üìä `[APP]` - app lifecycle —Å—ä–±–∏—Ç–∏—è
- ‚ùå `[ERROR]` - –≥—Ä–µ—à–∫–∏
- ‚ö†Ô∏è `[WARNING]` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚úÖ `[SUCCESS]` - —É—Å–ø–µ—à–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏

## –ö–∞–∫ –¥–∞ —Å–µ –ø—Ä–æ—Å–ª–µ–¥–∏ –ø—Ä–æ–±–ª–µ–º—ä—Ç —Å–µ–≥–∞

1. **–û—Ç–≤–æ—Ä–µ—Ç–µ Browser Console** (F12)
2. –ö–∞—á–µ—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç –≥–∞–ª–µ—Ä–∏—è—Ç–∞
3. –°–ª–µ–¥–µ—Ç–µ –ª–æ–≥–æ–≤–µ—Ç–µ:
   - –í–∏–∂—Ç–µ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–æ—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - –í–∏–∂—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ —Å–ª–µ–¥ 1st –∏ 2nd pass –∫–æ–º–ø—Ä–µ—Å–∏—è
   - –í–∏–∂—Ç–µ storage usage –ø—Ä–µ–¥–∏ –∏ —Å–ª–µ–¥
   - –ê–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∞, —â–µ –≤–∏–¥–∏—Ç–µ —Ç–æ—á–Ω–æ –∫—ä–¥–µ —Å–µ —Å–ª—É—á–≤–∞

## –ö–∞–∫–≤–æ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—Ç–µ –∞–∫–æ –ø—Ä–æ–±–ª–µ–º—ä—Ç –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞

1. **–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ storage usage:**
   ```javascript
   // –í browser console
   await window.spark.kv.keys()  // –í–∏–∂—Ç–µ –≤—Å–∏—á–∫–∏ –∫–ª—é—á–æ–≤–µ
   ```

2. **–ò–∑—á–∏—Å—Ç–µ—Ç–µ storage:**
   ```javascript
   // –í browser console
   await window.spark.kv.delete('analysis-history')
   await window.spark.kv.delete('analysis-report')
   ```

3. **–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ Browser DevTools -> Application -> Storage**
   - –í–∏–∂—Ç–µ –∫–æ–ª–∫–æ –º—è—Å—Ç–æ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞
   - –ò–∑—á–∏—Å—Ç–µ—Ç–µ —Ä—ä—á–Ω–æ –∞–∫–æ –µ –Ω—É–∂–Ω–æ

4. **–ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ QuickDebugPanel:**
   - –ö–ª–∏–∫–Ω–µ—Ç–µ –Ω–∞ –∂—ä–ª—Ç–æ—Ç–æ –±—É—Ç–æ–Ω—á–µ —Å –±—ä–≥ –≤ –¥–æ–ª–Ω–∏—è –¥–µ—Å–µ–Ω —ä–≥—ä–ª
   - –í–∏–∂—Ç–µ diagnostic –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ storage –∏ API-—Ç–∞

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–µ—Ç–∞–π–ª–∏

### –†–∞–∑–º–µ—Ä–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ç–∞
- **–û—Ä–∏–≥–∏–Ω–∞–ª –æ—Ç –∫–∞–º–µ—Ä–∞/–≥–∞–ª–µ—Ä–∏—è:** 2-5 MB
- **–°–ª–µ–¥ 1st pass –∫–æ–º–ø—Ä–µ—Å–∏—è:** 80-150 KB
- **–°–ª–µ–¥ 2nd pass –∫–æ–º–ø—Ä–µ—Å–∏—è:** 50-100 KB
- **–ú–∞–∫—Å–∏–º–∞–ª–µ–Ω –ª–∏–º–∏—Ç:** 200 KB

### Storage limits
- **Browser storage quota:** –û–±–∏–∫–Ω–æ–≤–µ–Ω–æ 50-100 MB
- **–ü—Ä–µ–ø–æ—Ä—ä—á–∞–Ω usage:** –ü–æ–¥ 80%
- **–ö—Ä–∏—Ç–∏—á–µ–Ω usage:** –ù–∞–¥ 90%
- **–î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ–Ω:** –ü–æ–∫–∞–∑–≤–∞ –≥—Ä–µ—à–∫–∞ –∏ —Å–ø–∏—Ä–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ç–∞

### Error recovery
- –ì—Ä–µ—à–∫–∏—Ç–µ —Å–µ –ª–æ–≥–≤–∞—Ç –≤ errorLogger
- ErrorBoundary —Ö–≤–∞—â–∞ –≥—Ä–µ—à–∫–∏ –∏ –ø–æ–∫–∞–∑–≤–∞ user-friendly —Å—ä–æ–±—â–µ–Ω–∏–µ
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –ù–ï —Å–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
- –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –º–æ–∂–µ –¥–∞ –æ–ø–∏—Ç–∞ –æ—Ç–Ω–æ–≤–æ –∏–ª–∏ –¥–∞ –ø—Ä–µ–∑–∞—Ä–µ–¥–∏ —Ä—ä—á–Ω–æ

## –°–ª–µ–¥–≤–∞—â–∏ —Å—Ç—ä–ø–∫–∏ (–∞–∫–æ –ø—Ä–æ–±–ª–µ–º—ä—Ç –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞)

1. **–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º—ä—Ç –µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
   - –û–ø–∏—Ç–∞–π—Ç–µ —Å —Ä–∞–∑–ª–∏—á–Ω–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –û–ø–∏—Ç–∞–π—Ç–µ —Å –ø–æ-–º–∞–ª–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –ù–∞–ø—Ä–∞–≤–µ—Ç–µ —Å–Ω–∏–º–∫–∞ –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ (–∞–∫–æ –∏–º–∞ —Ç–∞–∫–∞–≤–∞ –æ–ø—Ü–∏—è)

2. **–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ browser compatibility:**
   - –û–ø–∏—Ç–∞–π—Ç–µ –≤ –¥—Ä—É–≥ –±—Ä–∞—É–∑—ä—Ä (Chrome, Firefox, Safari)
   - –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –≤–µ—Ä—Å–∏—è—Ç–∞ –Ω–∞ –±—Ä–∞—É–∑—ä—Ä–∞

3. **–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ device memory:**
   - –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–π—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞/–±—Ä–∞—É–∑—ä—Ä–∞
   - –ó–∞—Ç–≤–æ—Ä–µ—Ç–µ –¥—Ä—É–≥–∏ —Ç–∞–±–æ–≤–µ/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

4. **–î–æ–±–∞–≤–µ—Ç–µ –æ—â–µ error handling** –∞–∫–æ –≤–∏–¥–∏—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞ –≥—Ä–µ—à–∫–∞ –≤ –ª–æ–≥–æ–≤–µ—Ç–µ
