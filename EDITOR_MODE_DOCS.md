# Editor Mode - Детайлна Документация

## Обща Информация

Editor Mode е мощна функционалност в Airis, която позволява пълен контрол над структурата и съдържанието на репорт страницата. Тази функция е предназначена за разработчици и администратори, които искат да персонализират начина, по който информацията се показва на потребителите.

## Ключови Концепции

### Модули (Modules)
Модулите са най-високото ниво на организация в репорта. Всяко приложение има 3 основни модула:
- **Overview** (Обща Информация) - биометрия, цели, начин на живот
- **Iridology** (Иридологичен Анализ) - находки от ляв и десен ирис
- **Plan** (План за Действие) - препоръки, хранене, добавки

### Контейнери (Containers)
Всеки модул се състои от множество контейнери. Контейнерът е най-малката единица, която може да бъде управлявана. Примери за контейнери:
- Карти с биометрични данни
- Графики със системни резултати
- Списъци с препоръки
- Интерактивни визуализации

Всеки контейнер има:
- **ID** - уникален идентификатор
- **Тип** - card, chart, list, text, image, collapsible, custom
- **Заглавие** - име на контейнера
- **Видимост** - дали се показва или е скрит
- **Ред** - позиция в модула
- **Коментари** - инструкции за AI
- **Метаданни** - допълнителна информация (икони, приоритет, и др.)

## Как Работи Editor Mode

### Активиране
1. Отидете в **Admin Panel** → **Editor Mode**
2. Включете превключвателя "Editor Mode"
3. Всички модули и контейнери ще станат редактируеми

### Управление на Контейнери

#### Пренареждане
- Хванете контейнера за иконата с 6 точки (drag handle)
- Плъзнете го нагоре или надолу
- Пуснете на желаната позиция
- Промените се запазват автоматично

#### Скриване/Показване
- Кликнете на иконата "око" в горния десен ъгъл на контейнера
- Скритите контейнери стават полупрозрачни и имат етикет "Скрит"
- Скритите контейнери не се показват на потребителите (когато Editor Mode е изключен)

#### Изтриване
- Кликнете на иконата "кошче"
- Потвърдете действието
- Контейнерът се премахва перманентно

#### Коментари и Инструкции
Системата за коментари позволява да давате точни инструкции за промени:

1. Кликнете на иконата за чат балонче
2. Отворете модалния прозорец с коментари
3. Напишете коментар с описание на желаната промяна
4. Кликнете "Добави Коментар"

**Примери за добри коментари:**
```
Промени цвета на графиката от син на зелен

Добави още 2 метрики: качество на кожата и качество на косата

Премахни секцията с BMI и добави секция за телесна композиция

Направи заглавието по-голямо и центрирано

Добави икона пред всяка препоръка
```

**Какво да включите в коментар:**
- Ясно описание на проблема
- Конкретна инструкция за промяна
- Референции (ако има)
- Приоритет (спешно, важно, nice-to-have)

#### Разрешаване на Коментари
- След като промяната е направена, кликнете иконата за отметка
- Коментарът ще бъде маркиран като "разрешен"
- Разрешените коментари се показват със зелен цвят

### Метаданни на Контейнери

Всеки контейнер има метаданни, които можете да прегледате:
- Кликнете на иконата "молив" (pencil)
- Вижте ID, тип, интерактивност
- Прегледайте JSON структурата на метаданните

## Практически Примери

### Пример 1: Скриване на Биометрични Данни
Ако искате да скриете биометричните данни от репорта:
1. Активирайте Editor Mode
2. Отидете в Overview модула
3. Намерете контейнера "Биометрични данни"
4. Кликнете иконата "око" → контейнерът се скрива
5. Деактивирайте Editor Mode
6. Потребителите вече няма да виждат този контейнер

### Пример 2: Преместване на Графика
Ако искате графиката със системни резултати да е по-горе:
1. Активирайте Editor Mode
2. Хванете "Системни Резултати" за drag handle
3. Плъзнете го до желаната позиция
4. Пуснете го
5. Деактивирайте Editor Mode

### Пример 3: Добавяне на Инструкция за Промяна
Ако искате AI да промени нещо в "Начин на живот" контейнера:
1. Активирайте Editor Mode
2. Намерете контейнера "Начин на живот"
3. Кликнете иконата за коментари
4. Напишете: "Добави метрика за качество на въздуха в помещението"
5. Запазете коментара
6. AI ще види този коментар в следващата итерация

## Мониторинг и Статистики

Admin панелът показва:
- **Брой модули** - общо активни модули
- **Брой контейнери** - общо и видими
- **Отворени коментари** - нерешени задачи
- **Решени коментари** - завършени промени

## Експорт на Коментари

Можете да експортирате всички коментари в JSON формат:
1. Отидете в Admin Panel → Editor Mode
2. Намерете секцията "Експорт на Коментари"
3. Кликнете "Свали Всички Коментари"
4. Файлът се изтегля с timestamp

## Най-Добри Практики

### За Коментари
✅ **Добре:**
- "Добави икона за сърце пред 'Сърдечно-съдова система'"
- "Промени цвета на 'concern' зони от червено на оранжево"
- "Направи този контейнер разтегливо (collapsible) по подразбиране"

❌ **Лошо:**
- "Промени го"
- "Не ми харесва"
- "Оправи"

### За Структура
- Не изтривайте контейнери преди да сте сигурни
- Ползвайте скриване вместо изтриване за експерименти
- Разглеждайте мобилна версия след промени
- Тествайте с реални данни

### За Производителност
- Не скривайте твърде много контейнери наведнъж
- Поддържайте логическа структура на реда
- Пренареждайте със смисъл (не на случаен принцип)

## Технически Детайли

### Структура на Контейнер
```typescript
interface ReportContainer {
  id: string
  moduleId: string
  type: 'card' | 'chart' | 'list' | 'text' | 'image' | 'collapsible' | 'custom'
  title: string
  visible: boolean
  order: number
  comments: ReportModuleComment[]
  interactive: boolean
  metadata?: {
    icon?: string
    priority?: 'high' | 'medium' | 'low'
    chartType?: string
    dataKey?: string
    [key: string]: any
  }
}
```

### Персистенция
Всички промени се записват в:
- `localStorage` key: `editor-mode-config`
- Автоматично синхронизиране между табове
- Запазва се при refresh на страницата

### Съвместимост
- Работи на всички съвременни браузъри
- Responsive дизайн (desktop и mobile)
- Touch support за мобилни устройства

## Често Задавани Въпроси

**В: Губят ли се промените при refresh?**
О: Не, всички промени се записват автоматично и персистират.

**В: Мога ли да върна изтрит контейнер?**
О: Да, чрез "Нулирай Модули" в Admin Panel, но това връща всички промени.

**В: Виждат ли потребителите моите коментари?**
О: Не, коментарите са видими само в Editor Mode.

**В: Колко контейнера мога да добавя?**
О: В момента можете да управлявате съществуващите контейнери. Добавянето на нови контейнери изисква AI инструкции чрез коментари.

**В: Работи ли на мобилен телефон?**
О: Да, но препоръчваме desktop за по-удобна работа.

## Бъдещи Функции

Планирани подобрения:
- [ ] Drag & drop между модули
- [ ] Визуален редактор за custom контейнери
- [ ] Template система
- [ ] Undo/Redo функционалност
- [ ] Bulk операции (скрий/покажи множество наведнъж)
- [ ] Export/import на конфигурации
- [ ] Version control за промени
- [ ] Collaborative editing

## Поддръжка

За проблеми или въпроси:
- Проверете console за грешки
- Експортирайте коментарите преди да правите драстични промени
- Използвайте "Нулирай Модули" като последна опция
